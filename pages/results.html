---
layout: main
title: Search Results
permalink: /results
search_exclude: true
---

<noscript><br><br>Search is not available.<br>In order to use search, enable JavaScript</noscript>

<div id="results-container">
  </div>

<script src="./resources/js/search.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const initialQuery = urlParams.get('q') || ''; 

    const searchInput = document.getElementById('search-input');
    const resultsContainer = document.getElementById('results-container');
    const searchDataURL = './resources/json/search.json'; 
    let searchIndex = [];

    if (searchInput) {
        searchInput.value = initialQuery;
        searchInput.addEventListener('input', function() {
            const newQuery = this.value.toLowerCase().trim();
            displayResults(search(newQuery));

            const newUrl = new URL(window.location.href);
            newUrl.searchParams.set('q', newQuery);
            window.history.pushState({ path: newUrl.href }, '', newUrl.href);
        });
    }

    fetch(searchDataURL)
        .then(response => response.json())
        .then(data => {
            searchIndex = data;
            if (initialQuery) {
                displayResults(search(initialQuery));
            } else {
                resultsContainer.innerHTML = '<p>Please enter a search query.</p>';
            }
        })
        .catch(error => {
            console.error("Error loading search index:", error);
            resultsContainer.innerHTML = '<p style="color: red;">Search is currently unavailable. Could not load the index file.</p>';
        });

    function search(query) {
        if (!query || !searchIndex) {
            return [];
        }

        const lowerCaseQuery = query.toLowerCase().trim();
        
        return searchIndex.filter(item => {
            const title = item.title ? item.title.toLowerCase() : '';
            const aliases = item.aliases || ''; 
            
            const titleMatch = title.includes(lowerCaseQuery);
            const aliasMatch = aliases.includes(lowerCaseQuery);
            
            return titleMatch || aliasMatch;
        });
    }

    function displayResults(results) {
        resultsContainer.innerHTML = '';
        const baseURL = window.location.origin;

        if (results.length === 0) {
            resultsContainer.innerHTML = `<p style="padding: 20px; font-style: italic;">No results found for "${searchInput.value}".</p>`;
            return;
        }

        results.forEach(item => {
            const resultBox = document.createElement('div');
            resultBox.style.padding = '15px';
            resultBox.style.border = 'none';
            resultBox.style.marginBottom = '15px';
            resultBox.style.borderRadius = '0';
            resultBox.style.backgroundColor = 'var(--search-background-color)';
            resultBox.style.boxShadow = '0 2px 5px rgba(0,0,0,0.2)';
            
            const titleLink = document.createElement('a');
            titleLink.href = '/' + item.url; 
            titleLink.textContent = item.title;
            titleLink.style.fontSize = '1.2em';
            titleLink.style.fontWeight = 'bold';
            titleLink.style.display = 'block'; 
            
            const urlP = document.createElement('p');
            urlP.style.fontSize = '0.9em';
            urlP.style.color = 'lightgreen'; 
            urlP.style.marginBottom = '5px';

            const urlLink = document.createElement('a');
            urlLink.href = '/' + item.url;
            urlLink.textContent = baseURL + '/' + item.url;
            urlLink.style.color = 'inherit';
            urlLink.style.textDecoration = 'none';

            urlP.appendChild(urlLink);
            
            const descriptionP = document.createElement('p');
            descriptionP.innerHTML = item.snippet || ''; 
            descriptionP.style.marginTop = '0';
            descriptionP.style.marginBottom = '0';
            
            resultBox.appendChild(titleLink);
            resultBox.appendChild(urlP);
            resultBox.appendChild(descriptionP);
            
            resultsContainer.appendChild(resultBox);
        });
    }
});
</script>